<app-shop-header></app-shop-header>

<router-outlet></router-outlet>

<section class="shop">

  <div class="shop-editorial-bg"></div>

  <div class="shop-content">

    <div class="shop-hero reveal">
      <h1>Cat√°logo</h1>
      <p>Explora nuestra colecci√≥n de productos exclusivos</p>
    </div>

    <!-- üî¥ Error categor√≠as -->
    <div *ngIf="errorCategorias" class="alert alert-danger">
      {{ errorCategorias }}
    </div>

    <!-- Categor√≠as -->
    <div class="shop-categories reveal">
      <button (click)="filtrarPorCategoria(null)">Todos</button>

      <button *ngFor="let categoria of categorias"
              (click)="filtrarPorCategoria(categoria)">
        {{ categoria.nombre }}
      </button>
    </div>

    <!-- üîç Buscador (üî• AHORA FUNCIONA) -->
    <div class="shop-search reveal">
      <input type="text"
             placeholder="Buscar productos..."
             [(ngModel)]="busqueda"
             (input)="buscarProducto()">
    </div>

    <!-- üî¥ Error productos -->
    <div *ngIf="errorProductos" class="alert alert-danger">
      {{ errorProductos }}
    </div>

    <!-- ü¶¥ Skeleton -->
    <div class="shop-grid" *ngIf="cargando">
      <div class="product-card skeleton" *ngFor="let s of [1,2,3,4,5,6,7,8]"></div>
    </div>

    <!-- Grid -->
    <div class="shop-grid" *ngIf="!cargando">
      <div class="product-card reveal"
           *ngFor="let producto of productosFiltrados; let i = index; trackBy: trackById"
     [style.transitionDelay]="(i * 120) + 'ms'"
     (click)="irADetalle(producto)"
     style="cursor:pointer">

        <!-- ‚úÖ CLICK A DETALLE -->
        <img
    [src]="getImagen(producto)"
    [alt]="producto.nombre"
    style="pointer-events:none"
  >

        <div class="product-info">
          <!-- ‚úÖ CLICK A DETALLE -->
          <h3>{{ producto.nombre }}</h3>
    <span class="price">${{ producto.precio | number }}</span>
    <p>{{ producto.descripcion }}</p>
    <p><strong>Categor√≠a:</strong> {{ producto.categoria?.nombre }}</p>
    <p><strong>Stock:</strong> {{ producto.stock }}</p>

    <button (click)="agregarAlCarrito(producto); $event.stopPropagation()">
      Agregar al carrito
    </button>
        </div>
      </div>
    </div>

  </div>
</section>
