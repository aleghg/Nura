<header class="shop-header">
  <div class="inner">

    <!-- LOGO -->
    <div class="logo" routerLink="/shop">NÃœRA</div>

    <div class="shop-actions">

      <!-- ðŸ”“ NO LOGUEADO -->
      <ng-container *ngIf="!auth.isAuthenticated()">
        <button (click)="openLogin()">Ingresar</button>
      </ng-container>

      <!-- ðŸ‘¤ CLIENTE -->
      <ng-container *ngIf="auth.getRol() === 'CLIENTE' && (usuario$ | async) as usuario">

        <!-- PERFIL -->
        <button routerLink="/perfil" class="profile-btn" title="Ver perfil">
          <img src="/icons/perfil.png" alt="Perfil" class="profile-icon" />
        </button>

        <!-- CARRITO CON DROPDOWN -->
        <div class="cart-dropdown" (mouseenter)="dropdownOpen = true" (mouseleave)="dropdownOpen = false">
          <button class="cart-btn" title="Carrito" routerLink="/shop/carrito">
            <img src="/icons/carrito-de-compras.png" class="cart-icon" />
            <span class="cart-count" [class.bump]="animarCarrito">{{ carritoCantidad }}</span>
          </button>

          <!-- MENU DROPDOWN -->
          <div class="cart-menu" *ngIf="dropdownOpen && carritoCantidad > 0">

            <div *ngFor="let item of cartItems" class="cart-preview-item">
              <img [src]="item.producto.imagen | safeImage"
                (error)="onImgError($event)"
                alt="{{ item.producto.nombre }}">

              <div class="preview-info">
                <span>{{ item.producto.nombre }}</span>
                <span>{{ item.cantidad }} x ${{ item.producto.precio | number }}</span>
                <button (click)="removerItem(item.producto.idProducto)">âœ•</button>
              </div>
            </div>

            <div class="cart-footer">
              <span>Total: ${{ totalCarrito | number }}</span>
              <button routerLink="/shop/carrito" class="view-cart-btn">Ver carrito</button>
            </div>
          </div>
        </div>

        <!-- SALIR -->
        <button (click)="logout()">Salir</button>
      </ng-container>

      <!-- ðŸ‘‘ ADMIN -->
      <ng-container *ngIf="auth.getRol() === 'ADMIN'">
        <button routerLink="/admin/productos">Productos</button>
        <button routerLink="/admin/categorias">CategorÃ­as</button>
        <button routerLink="/admin/usuarios">Usuarios</button>
        <button (click)="logout()">Salir</button>
      </ng-container>

    </div>

  </div>
</header>